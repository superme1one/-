![](asserts/Pasted%20image%2020250814102440.png)
### 如何实现文本生成
![](asserts/Pasted%20image%2020250814102657.png)


### 因果语言模型(Causal LM)
![](asserts/Pasted%20image%2020250814102743.png)
![](asserts/Pasted%20image%2020250814102902.png)
### 多轮推理
![](asserts/Pasted%20image%2020250814103125.png)
- 重复计算
### kv cache
![](asserts/Pasted%20image%2020250814103158.png)

![](asserts/Pasted%20image%2020250814104749.png)
Prefill
- 主要是把算力用完
Decode阶段
### Ai对话
![](asserts/Pasted%20image%2020250814105138.png)


![](asserts/Pasted%20image%2020250814105405.png)
### Ai对话Template
![](asserts/Pasted%20image%2020250814105549.png)

### 采样
![](asserts/Pasted%20image%2020250814105804.png)
随机采样有概率选到错误的词
改进：
![](asserts/Pasted%20image%2020250814110401.png)
![](asserts/Pasted%20image%2020250814110536.png)
实践中两者都可以用
![](asserts/Pasted%20image%2020250814110614.png)

![](asserts/Pasted%20image%2020250814110717.png)
保留多个分支的可能性

### DeepSeek
![](asserts/Pasted%20image%2020250814111009.png)


![](asserts/Pasted%20image%2020250814111125.png)


![](asserts/Pasted%20image%2020250814111222.png)

模型参数文件

1.5B 15亿参数
